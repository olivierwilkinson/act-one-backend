# Migration `20240826205344-add-indexes-to-play-models`

This migration has been generated by Olivier Wilkinson at 8/26/2024, 9:53:44 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `Session` MODIFY `data` VARCHAR(191) NOT NULL

CREATE TABLE `Play` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `title` VARCHAR(191) NOT NULL,
    `description` VARCHAR(191) NOT NULL,
    `image` VARCHAR(191) NOT NULL,
    `imageLicenseUrl` VARCHAR(191) NOT NULL,
    `imageLicenseCode` VARCHAR(191) NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Scene` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `actNum` INT NOT NULL,
    `sceneNum` INT NOT NULL,
    `playId` INT,
    `index` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Line` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `player` VARCHAR(191) NOT NULL,
    `sceneId` INT,
    `index` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `LineRow` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `number` INT,
    `text` VARCHAR(191) NOT NULL,
    `lineId` INT,
    `index` INT NOT NULL,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `Scene` ADD FOREIGN KEY (`playId`) REFERENCES `Play`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Line` ADD FOREIGN KEY (`sceneId`) REFERENCES `Scene`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `LineRow` ADD FOREIGN KEY (`lineId`) REFERENCES `Line`(`id`) ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20240826144552-add-password-to-user..20240826205344-add-indexes-to-play-models
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -27,15 +27,15 @@
   password    String?
 }
 model Play {
-  id               Int      @id @default(autoincrement())
+  id               Int     @id @default(autoincrement())
   title            String
   description      String
   image            String
   imageLicenseUrl  String
   imageLicenseCode String
-  scenes           Scene[]  @relation
+  scenes           Scene[] @relation
 }
 model Scene {
   id       Int    @id @default(autoincrement())
@@ -43,21 +43,24 @@
   sceneNum Int
   lines    Line[] @relation
   play     Play?  @relation(fields: [playId], references: [id])
   playId   Int?
+  index    Int
 }
 model Line {
   id       Int       @id @default(autoincrement())
   player   String
   lineRows LineRow[] @relation
   scene    Scene?    @relation(fields: [sceneId], references: [id])
   sceneId  Int?
+  index    Int
 }
 model LineRow {
   id     Int    @id @default(autoincrement())
   number Int?
   text   String
   line   Line?  @relation(fields: [lineId], references: [id])
   lineId Int?
+  index  Int
 }
```


